diff -Nur -x '*.orig' -x '*.rej' smeserver-qpsmtpd-1.2.0/root/etc/e-smith/templates/var/service/qpsmtpd/config/goodrcptto/50DelegatedDomains mezzanine_patched_smeserver-qpsmtpd-1.2.0/root/etc/e-smith/templates/var/service/qpsmtpd/config/goodrcptto/50DelegatedDomains
--- smeserver-qpsmtpd-1.2.0/root/etc/e-smith/templates/var/service/qpsmtpd/config/goodrcptto/50DelegatedDomains	1970-01-01 10:00:00.000000000 +1000
+++ mezzanine_patched_smeserver-qpsmtpd-1.2.0/root/etc/e-smith/templates/var/service/qpsmtpd/config/goodrcptto/50DelegatedDomains	2006-05-17 13:48:43.506002073 +1000
@@ -0,0 +1,17 @@
+{
+    $OUT = "";
+
+    use esmith::DomainsDB;
+    my $ddb = esmith::DomainsDB->open_ro();
+
+    for my $domain ( $ddb->domains )
+    {
+        my $mail_server = $domain->prop('MailServer')
+                          || $DelegateMailServer
+                          || 'localhost';
+
+        next if ( $mail_server eq 'localhost' );
+
+        $OUT .= '@' . $domain->key . "\n";
+    }
+}
