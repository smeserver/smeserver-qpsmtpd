diff -Nur -x '*.orig' -x '*.rej' smeserver-qpsmtpd-1.0.0/root/etc/e-smith/templates/var/service/qpsmtpd/config/plugins/80clamav mezzanine_patched_smeserver-qpsmtpd-1.0.0/root/etc/e-smith/templates/var/service/qpsmtpd/config/plugins/80clamav
--- smeserver-qpsmtpd-1.0.0/root/etc/e-smith/templates/var/service/qpsmtpd/config/plugins/80clamav	2005-08-19 15:31:01.000000000 -0600
+++ mezzanine_patched_smeserver-qpsmtpd-1.0.0/root/etc/e-smith/templates/var/service/qpsmtpd/config/plugins/80clamav	2005-09-23 00:34:35.270143032 -0600
@@ -3,5 +3,12 @@
 
     return "# clamav disabled" unless ($smtpd{VirusScan} eq "enabled");
 
-    "virus/clamav clamscan_path=/usr/bin/clamdscan action=reject";
+    my $max_size = $qpsmtpd{MaxScannerSize} || $clamav{MaxStreamSize} || "25M";
+    $max_size =~ s/[kK]/000/;
+    $max_size =~ s/[mM]/000000/;
+
+    $OUT = "virus/clamav" .
+		" clamscan_path=/usr/bin/clamdscan" .
+		" action=reject" . 
+    		" max_size $max_size";
 }
